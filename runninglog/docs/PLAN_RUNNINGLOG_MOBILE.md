# 러닝로그 모바일 앱 개발 플랜

## 1. 개요

**서비스명**: 러닝로그 (Running Log)  
**목적**: 웹 서비스를 모바일로 확장하며, 달리기 기록·푸시 등 **네이티브 전용 기능**을 제공하는 러너용 앱  

**디자인**
- **타겟**: 30대 남성
- **무드**: Modern, Precise, Sporty
- **로고**: `assets/images/runninglog.png`, `assets/images/runninglog.svg` (인앱은 PNG 사용, 상수는 `constants/assets.ts`의 `Logo`)

**핵심 기능**
1. 마라톤 대회 정보 제공
2. 달리기/스포츠/건강 관련 건강고민 상담
3. 달리기 기록 생성 및 리포트

### 인증 및 진입 흐름

- **앱은 기본적으로 로그인 후 이용** (로그인 필수 서비스).
- **스플래시 후 로그인 상태 확인**  
  - 로그인 되어 있음 → **홈 화면** `(tabs)` 으로 이동  
  - 로그인 되어 있지 않음 → **로그인 화면** `(auth)/login` 으로 이동
- **로그인 방식**
  1. **이메일 로그인** (이메일 + 비밀번호)
  2. **카카오톡 소셜 로그인**

### API 서버 (Swagger)

| 항목 | URL |
|------|-----|
| **Swagger UI** | http://0.0.0.0:8000/api/docs/ |
| **API 베이스** | `constants/api.ts`의 `API_BASE_URL` 사용 (환경변수 `EXPO_PUBLIC_API_HOST`로 오버라이드 가능) |

- 실제 기기 테스트 시: 개발 PC의 IP로 변경 (예: `http://192.168.x.x:8000`)
- Android 에뮬레이터: `http://10.0.2.2:8000`

---

## 2. 단계별 개발 플랜

### Phase 0: 기반 작업 (1~2주)

| 항목 | 내용 |
|------|------|
| **앱 아이덴티티** | 앱 이름, 로고, 스플래시, 테마 컬러(러닝/헬스 톤) 적용 |
| **네비게이션 구조** | 탭: 홈 / 대회 / 상담 / 기록·리포트 / 마이페이지(설정) 등 확정 |
| **인증** | 스플래시 후 로그인 상태 확인 → 로그인 시 홈, 비로그인 시 로그인 화면. 이메일 + 카카오 소셜 로그인. 토큰은 `expo-secure-store` 저장. |
| **API 연동** | 기존 웹 백엔드 API 베이스 URL, 인증 방식 정의 및 API 클라이언트 셋업 |

**산출물**: 공통 레이아웃, 테마, API 클라이언트, 인증 플로우(로그인 필수, 이메일/카카오)

---

### Phase 1: 마라톤 대회 정보 (1~2주)

| 기능 | 설명 | 비고 |
|------|------|------|
| 대회 목록 | 지역/날짜/이름 검색, 필터, 정렬 | 웹 API 재사용 가능 |
| 대회 상세 | 일정, 코스, 신청 방법, 링크 | |
| 찜/알림 | 관심 대회 저장, 대회 D-day 푸시 | **푸시 연동** |
| 캘린더 연동 | 대회 일정을 기기 캘린더에 추가 | 네이티브 캘린더 API |

**화면 예시**: `(tabs)/events/index`, `(tabs)/events/[id]`, 찜 목록

---

### Phase 2: 건강고민 상담 (1~2주)

| 기능 | 설명 | 비고 |
|------|------|------|
| 상담 목록/검색 | 달리기·부상·영양 등 카테고리/키워드 | 웹 콘텐츠 API 재사용 |
| 상담 글 보기 | 본문, 이미지, 관련 글 추천 | |
| 새 질문 작성 | 글쓰기 + (선택) 사진 첨부 | 인증 필요 |
| 알림 | 내 질문에 답변 달리면 푸시 | **푸시 연동** |

**화면 예시**: `(tabs)/consult/index`, `(tabs)/consult/[id]`, `(tabs)/consult/write`

---

### Phase 3: 달리기 기록 및 리포트 (2~3주) ⭐ 네이티브 중심

| 기능 | 설명 | 비고 |
|------|------|------|
| **기록 시작/종료** | GPS 기반 실시간 거리·페이스·시간 | `expo-location` + 백그라운드 |
| **러닝 중 화면** | 현재 페이스, 거리, 시간, 지도(선택) | 배터리/UI 최적화 |
| **기록 저장** | 루트, 거리, 시간, 페이스, 칼로리(선택) | 로컬 DB + 서버 동기화 |
| **기록 목록/상세** | 과거 러닝 목록, 지도/그래프로 상세 보기 | |
| **리포트** | 주/월별 요약, 목표 대비 달성률, 간단 통계 | 웹 리포트 로직 재사용 가능 |

**필수 네이티브/라이브러리**
- **위치**: `expo-location` (포그라운드/백그라운드 정책 확인)
- **백그라운드 러닝**: `expo-task-manager` + `expo-location` 또는 `react-native-background-geolocation`(유료) 검토
- **로컬 저장**: `expo-sqlite` 또는 AsyncStorage + 서버 동기화
- **지도**: `react-native-maps` 또는 Expo 호환 지도 라이브러리

**화면 예시**: `(tabs)/run/` (기록 목록), `run/active` (러닝 중), `run/[id]` (상세), `run/report` (리포트)

---

### Phase 4: 푸시 및 기타 네이티브 (1주)

| 항목 | 내용 |
|------|------|
| **푸시 알림** | `expo-notifications` + FCM(Android) / APNs(iOS), 토큰 서버 등록 |
| **알림 채널** | 대회 리마인더, 상담 답변, 주간 러닝 리포트 등 |
| **권한 UX** | 위치(항상/앱 사용 중), 알림, (선택) 백그라운드 앱 새로고침 안내 |

---

### Phase 5: 연동·안정화 (1~2주)

| 항목 | 내용 |
|------|------|
| **웹 데이터 연동** | 기존 웹 회원/대회/상담/기록 API와 동일 스펙으로 연동 |
| **오프라인** | 기록 작성 오프라인 저장 후 동기화, 목록 캐시 |
| **에러/로딩** | 전역 에러 바운더리, 재시도, 빈 상태 UI |
| **개발 빌드** | 네이티브 모듈 사용으로 **Expo Go 대신 Development Build** 사용 권장 (AGENTS.md 참고) |

---

## 3. 권장 앱 구조 (Expo Router)

```
app/
├── _layout.tsx                 # 루트 (테마, 인증 분기)
├── (auth)/                     # 비로그인 시
│   ├── login.tsx
│   └── join.tsx
├── (tabs)/                     # 메인 탭
│   ├── _layout.tsx             # 탭 바: 홈 | 대회 | 상담 | 기록 | 마이
│   ├── index.tsx               # 홈 (요약, 빠른 진입)
│   ├── events/
│   │   ├── index.tsx           # 대회 목록
│   │   └── [id].tsx            # 대회 상세
│   ├── consult/
│   │   ├── index.tsx           # 상담 목록
│   │   ├── [id].tsx            # 상담 글
│   │   └── write.tsx           # 질문 작성
│   ├── run/
│   │   ├── index.tsx           # 기록 목록
│   │   ├── active.tsx          # 러닝 중 (전용 레이아웃)
│   │   ├── [id].tsx            # 기록 상세
│   │   └── report.tsx          # 리포트
│   └── my/
│       └── index.tsx           # 마이페이지/설정
├── modal.tsx                   # (기존 유지 또는 용도 변경)
└── +not-found.tsx
```

---

## 4. 기술 스택 정리

| 구분 | 선택 |
|------|------|
| 프레임워크 | **Expo (SDK 54)** + React Native |
| 라우팅 | **Expo Router** (파일 기반) |
| 상태 | 전역: Context 또는 Zustand/Redux 중 택 1 (기록·인증 등) |
| API | fetch + 공통 클라이언트 또는 axios |
| 위치/러닝 | expo-location, expo-task-manager (백그라운드 검토) |
| 푸시 | expo-notifications |
| 지도 | react-native-maps (Expo config plugin 필요) |
| 로컬 DB | expo-sqlite 또는 expo-sqlite/kv-store |

---

## 5. 웹 → 모바일 마이그레이션 시 유의사항

- **API**: 기존 REST/GraphQL 그대로 사용 가능. 모바일 전용 엔드포인트(예: 푸시 토큰 등록)만 추가.
- **인증**: JWT/세션 등 웹과 동일 방식 + 보안 저장소(`expo-secure-store`)에 액세스 토큰 저장. 로그인 방식: 이메일, 카카오 소셜.
- **콘텐츠**: 대회/상담 데이터는 웹과 동일 소스 사용하면 일관성 유지 가능.
- **달리기 기록**: 웹에 기록 기능이 있었다면 스키마 호환; 없었다면 새로 설계 후 웹에서도 조회 가능하게 하면 좋음.

---

## 6. 다음 액션

1. **Phase 0**부터 진행: 앱 이름/테마 반영, 탭 구조를 현재 `(tabs)`에 맞춰 수정.
2. **기존 웹 API 스펙**이 있으면 문서/예시 공유 시, API 클라이언트와 타입을 바로 설계 가능.
3. **달리기 기록**은 네이티브 의존도가 크므로, Phase 1·2와 병행하거나 Phase 3에서 집중 구현 가능.

원하시면 Phase 0의 “탭 구조 변경 + 홈 화면을 러닝로그용으로 수정”부터 구체 코드 단위로 잡아드리겠습니다.
